<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src\site\markdown/extension\test-resource.md at 2022-12-10
 | Rendered using Apache Maven Fluido Skin 1.11.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>junit-support &#x2013; @TestResource</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.11.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-1.11.1.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>junit-support</h1>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2022-12-10<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.1</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">junit-support</li>
    <li><a href="../index.html" title="Overview"><span class="none"></span>Overview</a></li>
    <li><a href="../download.html" title="Download"><span class="none"></span>Download</a></li>
    <li><a href="https://github.com/robtimus/junit-support/releases" class="externalLink" title="Releases"><span class="none"></span>Releases</a></li>
    <li><a href="../apidocs/index.html" title="JavaDocs"><span class="none"></span>JavaDocs</a></li>
   <li class="nav-header">Extensions</li>
    <li class="active"><a><span class="none"></span>@TestResource</a></li>
    <li><a href="../extension/test-logger.html" title="@TestLogger"><span class="none"></span>@TestLogger</a></li>
   <li class="nav-header">Extension Support</li>
    <li><a href="../extension/method-lookup.html" title="MethodLookup"><span class="none"></span>MethodLookup</a></li>
    <li><a href="../extension/injecting-extensions.html" title="Injection extensions"><span class="none"></span>Injection extensions</a></li>
   <li class="nav-header">Various</li>
    <li><a href="../pre-defined-tests.html" title="Pre-defined tests"><span class="none"></span>Pre-defined tests</a></li>
    <li><a href="../assertion-failed-error-builder.html" title="AssertionFailedErrorBuilder"><span class="none"></span>AssertionFailedErrorBuilder</a></li>
    <li><a href="../additional-assertions.html" title="Additional assertions"><span class="none"></span>Additional assertions</a></li>
    <li><a href="../parameterized-test-support.html" title="Parameterized test support"><span class="none"></span>Parameterized test support</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >

<section>
<h2><a name="a.40TestResource"></a>@TestResource</h2>
<p>A lot of people have one or more utility methods like this:</p>

<div class="source"><pre class="prettyprint"><code>private static String readResource(String name) {
    StringBuilder sb = new StringBuilder();
    try (Reader input = new InputStreamReader(MyClassTest.class.getResourceAsStream(name), StandardCharsets.UTF_8)) {
        char[] buffer = new char[4096];
        int len;
        while ((len = input.read(buffer)) != -1) {
                sb.append(buffer, 0, len);
        }
    } catch (IOException e) {
        throw new UncheckedIOException(e);
    }
    return sb.toString();
}
</code></pre></div>
<p>Instead of having to write this boilerplate code for every project (and sometimes for multiple test classes inside the same project), annotate fields, constructor parameters or method parameters with <a href="../apidocs/com/github/robtimus/junit/support/extension/testresource/TestResource.html">@TestResource</a> to inject a Java resource into the field, constructor parameter or method parameter.</p>
<p>Note that the resource name is relative to the class that defines the method. Use a leading <code>/</code> to start from the root of the class path.</p><section>
<h3><a name="Injecting_byte.5B.5D"></a>Injecting byte[]</h3>
<p>The simplest form is to inject into a field, constructor parameter or method parameter of type <code>byte[]</code>. Just annotate the injection target with <code>@TestResource</code>:</p>

<div class="source"><pre class="prettyprint"><code>@Test
void testWithResource(@TestResource(&quot;my-file.bin&quot;) byte[] myFile) {
    // use myFile as needed
}
</code></pre></div></section><section>
<h3><a name="Injecting_String.2C_CharSequence_or_StringBuilder"></a>Injecting String, CharSequence or StringBuilder</h3>
<p>Injecting into a field, constructor parameter or method parameter of type <code>String</code>, <code>CharSequence</code> or <code>StringBuilder</code> works the same as for <code>byte[]</code>. In addition, the encoding and line separators can be specified.</p><section>
<h4><a name="Specifying_the_encoding"></a>Specifying the encoding</h4>
<p>By default, resources are loaded as UTF-8. In some cases this may not be the correct encoding. There are two ways to specify the encoding to use:</p>
<ul>

<li>Use <a href="../apidocs/com/github/robtimus/junit/support/extension/testresource/Encoding.html">@Encoding</a>. This annotation can be placed on the injection target, or any enclosing element. For instance, for a method parameter, it can be placed on the method parameter itself, the method, or the class that defines the method. If that class is nested inside another class, that class is also checked, up to the root class.</li>
<li>Use the <code>com.github.robtimus.junit.support.extension.testresource.encoding</code> JUnit configuration parameter to define the default encoding, in case no <code>@Encoding</code> annotation is found. This configuration parameter can have the following values:
<ul>

<li><code>DEFAULT</code> for <code>Charset.defaultCharset()</code></li>
<li><code>SYSTEM</code> for system property <code>file.encoding</code>; if this system property is not set, an error will be thrown</li>
<li><code>NATIVE</code> for system property <code>native.encoding</code>, which is available since Java 17; if this system property is not set, an error will be thrown</li>
<li>The name of a charset for that specific charset</li>
</ul>
</li>
</ul>
<p>For instance:</p>

<div class="source"><pre class="prettyprint"><code>@Test
void testWithResource(@TestResource(&quot;my-file.txt&quot;) @Encoding(&quot;ISO-8859-1&quot;) String myFile) {
    // myFile has been loaded using the ISO-8859-1 charset
}
</code></pre></div></section><section>
<h4><a name="Specifying_the_line_separator"></a>Specifying the line separator</h4>
<p>By default, the resource is loaded as-is. This may cause issues when tests are run on platforms with different line separators, for example Linux and Windows. There are two ways to specify the line separator to use:</p>
<ul>

<li>Use <a href="../apidocs/com/github/robtimus/junit/support/extension/testresource/EOL.html">@EOL</a>. This annotation can be placed on the injection target, or any enclosing element. For instance, for a method parameter, it can be placed on the method parameter itself, the method, or the class that defines the method. If that class is nested inside another class, that class is also checked, up to the root class.</li>
<li>Use the <code>com.github.robtimus.junit.support.extension.testresource.lineSeparator</code> JUnit configuration parameter to define the default line separator, in case no <code>@EOL</code> annotation is found. This configuration parameter can have the following values:
<ul>

<li><code>LF</code> for <code>\n</code></li>
<li><code>CR</code> for <code>\r</code></li>
<li><code>CRLF</code> for <code>\r\n</code></li>
<li><code>SYSTEM</code> for <code>System.lineSeparator()</code></li>
<li><code>ORIGINAL</code> for line separators from the original file; this is the default setting</li>
<li><code>NONE</code> for no line separators</li>
<li>A literal value for that specific line separator</li>
</ul>
</li>
</ul>
<p>For instance:</p>

<div class="source"><pre class="prettyprint"><code>@Test
void testWithResource(@TestResource(&quot;my-file.txt&quot;) @EOL(EOL.LF) String myFile) {
    // myFile uses \n as line separator, no matter the platform
}
</code></pre></div></section></section><section>
<h3><a name="Custom_resource-to-object_conversion"></a>Custom resource-to-object conversion</h3>
<p>Combine <code>@TestResource</code> with <a href="../apidocs/com/github/robtimus/junit/support/extension/testresource/LoadWith.html">@LoadWith</a> to provide your own resource-to-object conversion. For instance:</p>

<div class="source"><pre class="prettyprint"><code>@Test
void testWithResource(@TestResource(&quot;person.xml&quot;) @LoadWith(&quot;xmlToPerson&quot;) Person person) {
    // use person as needed
}

Person xmlToPerson(Reader reader) throws IOException {
    // perform conversion, e.g. using JAXB
}
</code></pre></div>
<p>The method reference in the annotation can come in the following formats:</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th>Format</th>
<th>Description</th></tr>
</thead><tbody>

<tr class="b">
<td align="left"><code>&lt;methodName&gt;</code></td>
<td>A method in the test class itself</td></tr>
<tr class="a">
<td align="left"><code>&lt;methodName(&lt;parameterTypes&gt;)</code></td>
<td>A method in the test class itself, with the given comma separated parameter types</td></tr>
<tr class="b">
<td align="left"><code>&lt;fullyQualifiedClassName&gt;#&lt;methodName&gt;</code></td>
<td>A method in the given class</td></tr>
<tr class="a">
<td align="left"><code>&lt;fullyQualifiedClassName&gt;#&lt;methodName&gt;(&lt;parameterTypes&gt;)</code></td>
<td>A method in the given class, with the given comma separated parameter types</td></tr>
</tbody>
</table>
<p>The parameter types can be one of the following combination; if they are not given, the method lookup will be performed in this order:</p>
<ul>

<li><code>java.io.Reader</code>, <code>com.github.robtimus.junit.support.extension.InjectionTarget</code></li>
<li><code>java.io.Reader</code>, <code>java.lang.Class</code></li>
<li><code>java.io.Reader</code></li>
<li><code>java.io.InputStream</code>, <code>com.github.robtimus.junit.support.extension.InjectionTarget</code></li>
<li><code>java.io.InputStream</code>, <code>java.lang.Class</code></li>
<li><code>java.io.InputStream</code></li>
</ul>
<p>The <a href="../apidocs/com/github/robtimus/junit/support/extension/InjectionTarget.html">InjectionTarget</a> or <code>Class</code> arguments represents the target or target type respectively, and can be used for dynamic conversion methods. For instance:</p>

<div class="source"><pre class="prettyprint"><code>@Test
void testWithResource(@TestResource(&quot;person.xml&quot;) @LoadWith(&quot;xmlToObject&quot;) Person person) {
    // use person as needed
}

@Test
void testWithResource(@TestResource(&quot;address.xml&quot;) @LoadWith(&quot;xmlToObject&quot;) Address address) {
    // use address as needed
}

&lt;T&gt; T xmlToObject(Reader reader, Class&lt;T&gt; type) throws IOException {
    // perform conversion, e.g. using JAXB
}
</code></pre></div><section>
<h4><a name="Specifying_the_encoding"></a>Specifying the encoding</h4>
<p>When using a method that takes a <code>Reader</code>, the encoding can be specified in the same way as for <code>String</code>, <code>CharSequence</code> or <code>StringBuilder</code>, using <code>@Encoding</code> or the <code>com.github.robtimus.junit.support.extension.testresource.encoding</code> JUnit configuration parameter. It's not allowed to use <code>@Encoding</code> for methods that take an <code>InputStream</code>.</p></section></section><section>
<h3><a name="Injecting_Properties"></a>Injecting Properties</h3>
<p>A specialized version of <code>@LoadWith</code> is provided for <code>Properties</code> objects, <a href="../apidocs/com/github/robtimus/junit/support/extension/testresource/AsProperties.html">@AsProperties</a>:</p>

<div class="source"><pre class="prettyprint"><code>// inject as a static field
@TestResource(&quot;test.properties&quot;)
@AsProperties
private static Properties testProperties;
</code></pre></div></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2020&#x2013;2022
</p>
        </div>
      </div>
    </footer>
<script>
	if(anchors) {
	  anchors.add();
	}
</script>
  </body>
</html>
